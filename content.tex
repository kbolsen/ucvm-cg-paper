\input{introduction}\section{Community Velocity Models}\label{sec:cvms}\textit{\color{blue}This section will present how CVMs work and the various CVMs available to the community today. It will basically explain that CVMs provide the triplets of Vs, Vp and density, and, as an example, we can expand on a description of CVM-S and CVM-H, including their variations CVM-SI and CVM-H+GTL.}\section{The UCVM Software Framework}\label{sec:ucvm}The primary functionality provided by UCVM is the ability to query a wide array of community velocity models for material properties in a standard way. Once a velocity model has been successfully integrated with UCVM, the framework can be utilized to query for the primary and shear seismic wave velocities ($Vp$, $Vs$) as well as the soil/rock density ($\rho$) at any geographic point within that model. The original model's local coordinate system and map projection are concealed behind a generic interface that instead allows queries by geographic latitude and longitude along with a vertical z-coordinate. The z-axis may be defined as either depth below the free surface or elevation relative to mean sea level.To support this flexible query mechanism consistently across all models, UCVM includes a high-resolution digital elevation model (DEM). The DEM is synthesized from the USGS National Elevation Dataset (TODO: cite USGS NED) and the ETOPO1 Global Relief Model (TODO: cite ETOPO1). It currently spans the State of California along with portions of surrounding States. However, it may be modified to cover any arbitrary region of the Earth's surface, provided adequate resolution elevation datasets exist.\begin{figure}\centering\epsfig{file=UCVM_Tiling_Concept.pdf,scale=0.35}\caption{Tiling of velocity models (TODO: Redo/cleanup this figure).}\label{fig:tiling}\end{figure}The framework further extends the standardized interface by allowing multiple velocity models to be aggregated into a single composite model. Composition is accomplished by tiling two or more velocity models in three dimensions according to a user-specified priority ordering. Under this scheme, a query point is submitted sequentially to each velocity model within the ordered list that comprises the composite. The first model to return valid velocity data for the point is considered to have fulfilled the data request and subsequent models are not queried. Thus, overlap among the individual models is acceptable and their relative priority ordering arbitrates which one satisfies any given query. Generally, no smoothing is performed at the interfaces between models (an exception is interpolation between a geotechnical layer and a crustal model as discussed later in this paper). This tiling concept is illustrated in Figure \ref{fig:tiling}.Community velocity models vary widely in their area of coverage, depth extent, and resolution. UCVM is flexible in its support for such variability. However, in order to better accommodate high frequency ground motion simulations, it categorizes models into two general groups: crustal models, and geotechnical layers (GTLs). Crustal models provide subsurface seismic wave velocities associated with basin, crust, and mantle structures. These models may potentially extend to many tens of kilometers below the Earth's surface yet do so at coarse resolutions (TODO: cite CVM-H, CVM-S). Geotechical layers, in contrast, provide velocities for only the near-surface (typically a few hundred meters) at very high resolution (TODO: cite Ely Vs30 GTL). Ground motion simulations, in particular, rely on high-resolution near-surface velocities and therefore a GTL serves to supplement the coarser data provided by crustal models.\begin{figure}\centering\epsfig{file=place_holder.pdf,scale=0.35}\caption{Interpolation of GTL and crustal model.}\label{fig:interpolation}\end{figure}When querying a set of velocity models that includes at least one GTL, the tiling mechanism described previously is enhanced to perform limited interpolation. The framework independently composes the GTLs and the crustal models into a composite GTL and composite crustal model, respectively, using the tiling technique. An interpolation zone is then defined along the z-axis between the two composites. Query points that fall within the zone are assigned an interpolated velocity based on the composite GTL velocity at the top of the zone boundary and the composite crustal model velocity at the bottom. By default, linear interpolation is used for the smoothing but both the zone dimensions and interpolation function can be modified by the user. Figure \ref{fig:interpolation} illustrates how this interpolation is performed. The primary motivation for performing interpolation in this particular case is to eliminate near-surface discontinuities between the GTLs and the crustal models which would adversely affect ground motion simulations.A single geotechnical layer is currently supported, based on Ely's Vs30-derived algorithm (TODO: cite Ely Vs30-derived GTL). This algorithm procedurally estimates $Vp$, $Vs$, and $\rho$ from the Vs30 velocity at the point of interest. To that end, two separate Vs30 maps are provided for use with the Ely GTL, and each covers the same geographic region as the DEM (namely, California). One map is based on the the Wills and Walls dataset (TODO: cite Wills and Wald), and the other is based on the Yong dataset (TODO: cite Yong). Alternative Vs30 maps may be integrated as new datasets become available. \subsection{Command-line Utilities}The UCVM software framework provides UNIX command-line utilities to interactively query velocity models and construct regular three-dimensional meshes of material properties. These programs are described in the following sections.\subsubsection{Querying}The primary command-line query tool is \emph{ucvm\_query}. The typical use case is to invoke the program by specifying the path to the UCVM configuration file and a prioritized list of models to query. The UCVM configuration file is created automatically during installation yet needs to be provided on the command line so that UCVM may find the necessary resources. The pool of available velocity models are selected by the user during installation, where they are downloaded from the UCVM website and installed simultaneously with UCVM. When executing \emph{ucvm\_query}, the subset of available models to be used in the current session are referenced by short text labels, and they are tiled in the order they are specified.Once running, the program loads the necessary models and awaits query coordinates from the user. The default format for coordinates is longitude (decimal), latitude (decimal), and depth (meters). Alternatively, elevation may be used for the z coordinate with a command-line option. For each submitted query point, UCVM returns a text line composed of seventeen fields. The first three fields of the output echo the original query coordinates. The next two fields list the surface elevation from the DEM and the Vs30 value from the active Vs30 map. Since both of these maps are gridded, bilinear interpolation is used to calculate smoothed values at the point of interest.The remaining twelve fields represent three groups of parameters consisting of four fields each. These groups correspond to material properties from a crustal model, a GTL (if any), and combined. The first field of each group lists the source model from which the material properties were drawn, and the other three fields list the material properties Vp, Vs, and $\rho$. Typically, only the combined material properties are of interest to the user, whereas the first two groups serve to show the inputs used in any interpolation.TODO: describe basin\_query\subsubsection{Meshing}TODO: single core and parallel meshing/etree extraction\subsection{Application Programming Interface}TODO: how to interface programmatically with UCVM\subsubsection{Extensibility}TODO: describe how to support new DEMs, Vs30 maps, and models\section{Computational Performance}\label{sec:conclusions}\textit{\color{blue}It would be desirable to do some experiments in terms of performance, especially for the parallel applications utilities in UCVM. With some examples of how long the same thing would take if doing it differently. We will need to discuss this.}\section{Recent Case Applications}\label{sec:conclusions}\textit{\color{blue}This section will be dedicated to show case applications. Some ideas for potential subsections follow.}\subsection{Visualization and Model Comparisons}\subsection{Chino Hills Simulation Series}\subsection{CyberShake}\section{Summary and Conclusions}\label{sec:conclusions}\textit{\color{blue}A couple of paragraphs with a summary of what is shown in the paper and a few key conclusions about the impact that we expect UCVM has already have and will have on earthquake research.}